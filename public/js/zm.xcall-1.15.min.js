var zmXCall=(function(window){var callbacks={},removeFlags={},html5=false,flash=false,scrollCallbacks=new Array(),scrollWnds=new Array();function serialize(data){if(typeof JSON=="object"&&JSON.stringify){return JSON.stringify(data)}if(data==undefined){return"undefined"}if(data==null){return"null"}try{if(typeof data=="string"||data.constructor.toString().match(/string/i)!=null){return'"'+data.replace('/\\"/g','\\"')+'"'}}catch(e){}var a;if(Object.prototype.toString.call(data).match(/array/i)!=null){a=new Array();var length=data.length;for(var i=0;i<length;i++){a.push(serialize(data[i]))}return"["+a.join(",")+"]"}if(typeof data=="object"){a=new Array();for(var f in data){a.push('"'+f+'":'+serialize(data[f]))}return"{"+a.join(",")+"}"}return data.toString()}if(window.postMessage){html5=true;var onmessage=function(e){try{var data=eval("("+e.data+")")}catch(e){return}if(data.xcallAction){switch(data.xcallAction){case"registerScrollHandler":var existed=false,wnd=e.source;for(var i=0;i<scrollWnds.length;i++){if(scrollWnds[i]==wnd){existed=true;break}}if(!existed){scrollWnds.push(e.source)}break;case"onScroll":for(var i=0;i<scrollCallbacks.length;i++){scrollCallbacks[i].call(window,data.xcallParams)}break;default:zmXCall.call(data.xcallAction,data.xcallParams,window,e.source);break}}};if(window.attachEvent){window.attachEvent("onmessage",onmessage)}else{window.addEventListener("message",onmessage,false)}if(typeof zm!="undefined"){zm(window).scroll(function(){if(scrollWnds.length==0){return}var msg=serialize({xcallAction:"onScroll",xcallParams:zmXCall.getTopSelf()});for(var i=0;i<scrollWnds.length;i++){scrollWnds[i].postMessage(msg,"*")}})}}var m=navigator.userAgent.toLowerCase().match(/(^|\s)(firefox|safari|opera|msie|chrome)[\/:\s]([\d\.]+)/)||["","","0.0"],msie=m[2]=="msie",opera=m[2]=="opera";if(!window.postMessage||msie){var flashUrl="http://static.me.zing.vn/swf/zmxcall-1.00.swf",playerId="zmxcall-obj",oAttrs={id:playerId,type:"application/x-shockwave-flash",width:"0",height:"0",data:flashUrl},oParams={movie:flashUrl,allowScriptAccess:"always"};if(msie&&!opera){oAttrs.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"}if((!msie)||opera){var e=document.createElement("OBJECT");for(var attrName in oAttrs){e.setAttribute(attrName,oAttrs[attrName])}for(var attrName in oParams){var p=document.createElement("PARAM");p.setAttribute("name",attrName);p.setAttribute("value",oParams[attrName]);e.appendChild(p)}document.body.appendChild(e)}else{var html="<object ";for(var attrName in oAttrs){html+=attrName+'="'+oAttrs[attrName]+'" '}html+=">";for(var attrName in oParams){html+='<param name="'+attrName+'" value="'+oParams[attrName]+'">'}html+="</object>";setTimeout(function(){var e=document.getElementById("zmxcall-obj");if(!e){e=document.createElement("DIV");e.setAttribute("id","zmxcall-obj");document.body.appendChild(e)}e.outerHTML=html},200)}}return{DEFAULT_PROXY_VERSION:"1.00",DEFAULT_HOST:"me.zing.vn",version:"1.14",window:window,enableFlash:function(){flash=true},getXCallID:function(){var fo=document.getElementById("zmxcall-obj");if(fo){return fo.getChannelID()}},register:function(name,callback,remove){callbacks[name]=callback;if(remove){removeFlags[name]=true}else{if(removeFlags[name]){delete removeFlags[name]}}},callByFlash:function(message){try{var o=eval("("+message+")");if(o.name){zmXCall.call(o.name,o.params,window)}}catch(e){}},call:function(name,params,wnd,source){if(!callbacks[name]){return}try{var rs=callbacks[name].call(wnd,params,source);if(rs){this.callParent(rs.callback,rs.params,rs.options,rs.window,true)}}catch(e){}if(removeFlags[name]){delete removeFlags[name];delete callbacks[name]}},callParent:function(funcName,params,options,wnd,postBack){if(!wnd){wnd=window}try{if(html5&&(wnd.parent==window||!postBack||window.opener==wnd)){if(!postBack&&window.opener!=wnd){wnd=wnd.parent}wnd.postMessage(serialize({xcallAction:funcName,xcallParams:params}),"*");return}}catch(e){}if(flash){var uri=window.location.href;var qs={};uri.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function($0,$1,$2,$3){qs[$1]=$3});if(qs.zmxcid){var fo=document.getElementById("zmxcall-obj"),msg=serialize({name:funcName,params:params});fo.callParentViaFlash(qs.zmxcid,msg);return}}options=options||{};options.host=options.host||zmXCall.DEFAULT_HOST;options.version=options.version||zmXCall.DEFAULT_PROXY_VERSION;var ifid="xcall-if-"+Math.floor(Math.random()*100);url="http://"+options.host+"/xcall.proxy-"+options.version+".html#"+encodeURIComponent(funcName+","+serialize(params)),tried=0;function doCall(){var e=wnd.document.createElement("IFRAME");e.style.visibility="hidden";e.style.display="none";e.width="0";e.height="0";e.src=url;e.id=ifid;try{wnd.document.body.appendChild(e)}catch(e){tried++;if(tried<3){setTimeout(doCall,200)}return}setTimeout(function(){try{var e=wnd.document.getElementById(ifid);wnd.document.body.removeChild(e)}catch(e){}},10000)}doCall()},resizeParent:function(params,options){if(typeof params=="string"||params.constructor.toString().match(/string/i)!=null){params={id:params}}if(!params.height){var D=document;params.height=Math.max(Math.max(D.body.scrollHeight,D.documentElement.scrollHeight),Math.max(D.body.offsetHeight,D.documentElement.offsetHeight),Math.max(D.body.clientHeight,D.documentElement.clientHeight))}this.callParent("resize",params,options)},setHashParent:function(hash,options){this.callParent("setHash",hash,options)},getTop:function(callback,options){var cbname="getTop"+Math.floor(Math.random()*100);this.register(cbname,callback,true);var params={host:window.location.host,cb:cbname};this.callParent("getTop",params,options)},getTopSelf:function(){var top,height,wnd=zmXCall.window,B=wnd.document.body,D=wnd.document.documentElement;if(typeof wnd.pageYOffset!="undefined"){top=wnd.pageYOffset}else{top=((D&&D.scrollTop)?D:B).scrollTop}if(typeof wnd.innerHeight!="undefined"){height=wnd.innerHeight}else{height=((D&&D.clientHeight)?D:B).clientHeight}return{top:top,height:height,docHeight:Math.max(0,document.body.offsetHeight)}},getViewport:function(callback,options){var cbname="getViewport"+Math.floor(Math.random()*100);this.register(cbname,callback,true);var params={host:window.location.host,cb:cbname};this.callParent("getViewport",params,options)},getViewportSelf:function(){var result={},wnd=zmXCall.window,docElem=wnd.document.documentElement,body=wnd.document.body;if(window.innerWidth){result.width=window.innerWidth;result.height=window.innerHeight}else{if(docElem&&docElem.offsetWidth){result.width=docElem.offsetWidth;result.height=docElem.offsetHeight}else{result.width=body.offsetWidth;result.height=body.offsetHeight}}if(typeof window.pageYOffset=="number"){result.offsetY=window.pageYOffset;result.offsetX=window.pageXOffset}else{if(docElem&&(docElem.scrollLeft||docElem.scrollTop)){result.offsetY=docElem.scrollTop;result.offsetX=docElem.scrollLeft}else{if(body&&(typeof body.scrollLeft=="number")){result.offsetY=body.scrollTop;result.offsetX=body.scrollLeft}}}return result},addScrollHook:function(cb){if(!html5){return}scrollCallbacks.push(cb);window.parent.postMessage('{xcallAction:"registerScrollHandler"}',"*")},openFullFrame:function(params,options){this.callParent("openFullFrame",params,options)},closeFullFrame:function(params,options){this.callParent("closeFullFrame",params,options)},openBoxy:function(title,url,width,height,options,proxyOptions){this.callParent("openBoxy",zm.extend({title:title,url:url,width:width,height:height},options),proxyOptions)},closeBoxy:function(options){this.callParent("closeBoxy",null,options)}}})(window);zmXCall.register("resize",function(a){if(!a.height){return}var b=zm(a.id?"#"+a.id:document);b.css("height",a.height+"px")});zmXCall.register("getTop",function(d,c){var a=zmXCall.getTopSelf(),b={host:d.host};b.version=d.version||zmXCall.DEFAULT_PROXY_VERSION;return{callback:d.cb,params:a,options:b,window:c||this}});zmXCall.register("setHash",function(a){window.location.hash=a});zmXCall.register("getViewport",function(c,b){var a={host:c.host,version:c.version||zmXCall.DEFAULT_PROXY_VERSION};return{callback:c.cb,params:zmXCall.getViewportSelf(),options:a,window:b||this}});zmXCall.register("openFullFrame",function(d){var m=d.headerSize?d.headerSize:33,i=zm("#header"),q=zm("#fullsized-frame"),a=zm.getViewport(),o,c=a.width-zm(document.body).width(),s=function(){if(zm.browser.msie&&zm.browser.version<"7"){a=zm.getViewport();q=zm("#fullsized-frame");q.css("height",(a.height-m)+"px");var e=zm(q.children()[1]).height();if(e+2<a.height-m){e=a.height-m}else{e+=2}zm(q.children()[0]).css("height",e+"px");zm("#fullsized-closebtn").css("left",(a.width-32)+"px")}},n=function(f){if(f.keyCode==27){zm("#fullsized-closebtn").click()}};if(i.css("position")=="fixed"){m=i.outerHeight()}else{if(i.size()>0){m=0}}if(zm.browser.msie&&zm.browser.version<"8"){c=0;o=document.createElement("STYLE");o.setAttribute("type","text/css");o.styleSheet.cssText="html {overflow: hidden} #fullsized-frame{overflow-y: auto !important}";document.getElementsByTagName("head")[0].appendChild(o)}else{zm(document.body).css({"margin-right":c+"px",overflow:"hidden"})}if(q.size()==0){var g=parseInt(d.height?d.height:500),r=d.width?d.width:980,l=zm.createElement("DIV",{id:"fullsized-frame"},{left:"0",width:"100%"}),k=zm.createElement("DIV",{},{position:"relative",border:"1px #000 solid",width:r+"px",height:g+"px",margin:"auto"}),j=zm.createElement("IFRAME",{src:d.url,border:0},{border:"0px none",height:g+"px",width:r+"px"}),p=zm.createElement("DIV",{id:"fullsized-closebtn",title:"Đóng"},{cursor:"pointer",top:"7px",left:(a.width-42)+"px",width:"20px",height:"20px",position:"fixed",zIndex:899,background:"transparent url(http://stc.ugc.zdn.vn/photo_v4/zme/images/imgsprtpho_1.06.gif) 0 -149px no-repeat"});k.appendChild(j);l.appendChild(k);if(zm.browser.msie&&zm.browser.version<"7"){zm(l).css({height:(a.height-m)+"px",position:"absolute",top:(a.offsetY+m)+"px",width:"100%"})}else{zm(l).css({position:"fixed",top:m+"px",bottom:0})}var b={"z-index":700,"background-color":"#fff"};if(m==0){b.top="33px"}zm(k).css(b);document.body.appendChild(l);q=zm(l);q.css({"z-index":699,"overflow-x":"hidden","overflow-y":"auto"});if(zm.browser.msie&&zm.browser.version<"9"){q.css("filter","progid:DXImageTransform.Microsoft.gradient(startColorstr=#B2000000, endColorstr=#B2000000)")}else{q.css("background-color","rgba(0, 0, 0, 0.7)")}q.click(function(){if(this.id=="fullsized-frame"){zm("#fullsized-closebtn").click()}});zm(window).bind("resize",s);document.body.appendChild(p);zm(document).keydown(n);zm(p).click(function(){zm(window).unbind("resize",s);zm(document).unbind("keydown",n);zm("#fullsized-closebtn").remove();zm("#fullsized-frame").remove();zm(document.body).css({"margin-right":"auto",overflow:"auto"});if(zm.browser.msie&&zm.browser.version<"8"){zm(o).remove()}typeof zmChat!="undefined"&&zmChat.displayTicker("revert")});typeof zmChat!="undefined"&&zmChat.displayTicker(false)}q.show()});zmXCall.register("resizeFullFrame",function(b){for(var a in b){if(a!="width"&&a!="height"){delete b[a]}else{b[a]+="px"}}if(zm.objectLength(b)==0){return}zm("#fullsized-frame").children().css(b);zm("#fullsized-frame iframe").css(b)});zmXCall.register("closeFullFrame",function(){zm("#fullsized-closebtn").click()});zmXCall.register("openBoxy",function(b){if(!zmXCall.boxy){zmXCall.boxy=new zm.Boxy({title:"",content:'<iframe id="xcallBoxyFrame" frameborder="0"></iframe>',footer:false})}b.footer=!!b.okButton;zmXCall.boxy.changeSettings(b);var a=zm("#xcallBoxyFrame");b.url&&a.attr("src",b.url);if(!a.attr("src")){return}b.width&&a.css("width",b.width+"px");b.height&&a.css("height",b.height+"px");if(!zmXCall.boxy.isShowing()){zmXCall.boxy.show()}else{zmXCall.boxy.center()}});zmXCall.register("closeBoxy",function(){zmXCall.boxy&&zmXCall.boxy.hide()});